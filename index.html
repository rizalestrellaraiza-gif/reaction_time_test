<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Neon vs Neutral Color Reaction Test</title>

  <!-- jsPsych core -->
  <script src="https://unpkg.com/jspsych@7.3.3/dist/jspsych.js"></script>

  <!-- jsPsych plugin -->
  <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@1.1.1/dist/index.browser.js"></script>

  <!-- CSS -->
  <link href="https://unpkg.com/jspsych@7.3.3/css/jspsych.css" rel="stylesheet" />

  <style>
    body { background-color: #000; color: white; text-align: center; }
    .color-box {
      width: 250px;
      height: 250px;
      margin: 100px auto;
      border-radius: 20px;
      border: 3px solid white;
    }
    .fixation {
      font-size: 60px;
      color: white;
      margin-top: 150px;
    }
  </style>
</head>

<body>
  <script>
    // Initialize jsPsych
    const jsPsych = initJsPsych({
      on_finish: function() {
        jsPsych.data.displayData();
      }
    });

    // =============================
    // Color settings
    // =============================
    const neonColors = [
      {color: '#FF6EC7', type: 'neon', name: 'neon pink'},
      {color: '#FFFF33', type: 'neon', name: 'neon yellow'},
      {color: '#FF9900', type: 'neon', name: 'neon orange'}
    ];

    const neutralColors = [
      {color: '#F5F5DC', type: 'neutral', name: 'beige'},
      {color: '#A9A9A9', type: 'neutral', name: 'gray'},
      {color: '#D2B48C', type: 'neutral', name: 'light brown'}
    ];

    // Duplicate and shuffle stimuli (12 trials)
    let stimuli = [...neonColors, ...neutralColors, ...neonColors, ...neutralColors];
    stimuli = jsPsych.randomization.shuffle(stimuli);

    // =============================
    // Instructions
    // =============================
    const instructions = {
      type: jsPsychHtmlKeyboardResponse,
      stimulus: `
        <h2>Neon vs Neutral Color Reaction Test</h2>
        <p>You will see a '+' appear briefly, followed by a colored box.</p>
        <p>Your task: <strong>press the SPACEBAR as fast as you can</strong> when the color appears.</p>
        <p>Try to be quick and accurate!</p>
        <p><em>Press any key to begin.</em></p>
      `
    };

    // =============================
    // Fixation cross (randomized)
    // =============================
    const fixation = {
      type: jsPsychHtmlKeyboardResponse,
      stimulus: "<div class='fixation'>+</div>",
      choices: "NO_KEYS",
      trial_duration: function() {
        // Random between 500â€“1500 ms
        return jsPsych.randomization.sampleWithoutReplacement([500, 750, 1000, 1250, 1500], 1)[0];
      }
    };

    // =============================
    // Color trial (reaction)
    // =============================
    const color_trial = {
      type: jsPsychHtmlKeyboardResponse,
      stimulus: function() {
        const c = jsPsych.timelineVariable('color');
        return `<div class='color-box' style='background-color:${c}'></div>`;
      },
      choices: [' '],
      prompt: "<p>Press SPACE as fast as you can!</p>",
      data: {
        type: jsPsych.timelineVariable('type'),
        color: jsPsych.timelineVariable('color'),
        name: jsPsych.timelineVariable('name')
      }
    };

    // =============================
    // Inter-trial interval (random blank)
    // =============================
    const iti = {
      type: jsPsychHtmlKeyboardResponse,
      stimulus: "",
      choices: "NO_KEYS",
      trial_duration: function() {
        return jsPsych.randomization.sampleWithoutReplacement([500, 1000, 1500], 1)[0];
      }
    };

    // =============================
    // Trial procedure
    // =============================
    const trial_procedure = {
      timeline: [fixation, color_trial, iti],
      timeline_variables: stimuli
    };

    // =============================
    // Run experiment
    // =============================
    jsPsych.run([instructions, trial_procedure]);
  </script>
</body>
</html>
